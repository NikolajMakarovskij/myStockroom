name: Django Actions

on: 
  push:
    branch: [backend]
  pull_request:
    branch: [master]

jobs:
  integration-tests:
    # На какой ОС будет работать виртуальная машина
    # Можно выбрать Ubuntu, Windows Server или macOS
    runs-on: ubuntu-latest
    strategy:
      max-parallel: 4
    steps:
      - uses: actions/checkout@v3
      - uses: isbang/compose-action@v1.4.1
        with:
          compose-file: "./backend/docker-compose.yaml"
          env_file: "./backend/.env.dev"
      - name: Run tests
        run: docker-compose exec -T web pytest --cov
      - name: Stop conteiners
        run: docker-compose down -v